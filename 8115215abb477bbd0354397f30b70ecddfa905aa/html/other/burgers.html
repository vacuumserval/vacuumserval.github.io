<!DOCTYPE html> <html lang=en  data-content_root="../"> <meta charset=utf-8  /> <meta name=viewport  content="width=device-width, initial-scale=1.0" /><meta name=viewport  content="width=device-width, initial-scale=1" /> <meta name=viewport  content="width=device-width,initial-scale=1"> <meta http-equiv=x-ua-compatible  content="ie=edge"> <meta name="lang:clipboard.copy" content="Copy to clipboard"> <meta name="lang:clipboard.copied" content="Copied to clipboard"> <meta name="lang:search.language" content=en > <meta name="lang:search.pipeline.stopwords" content=True > <meta name="lang:search.pipeline.trimmer" content=True > <meta name="lang:search.result.none" content="No matching documents"> <meta name="lang:search.result.one" content="1 matching document"> <meta name="lang:search.result.other" content="# matching documents"> <meta name="lang:search.tokenizer" content="[\s\-]+"> <link href="https://fonts.gstatic.com/" rel=preconnect  crossorigin> <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel=stylesheet > <style> body, input { font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif } code, kbd, pre { font-family: "Roboto Mono", "Courier New", Courier, monospace } </style> <link rel=stylesheet  href="../_static/stylesheets/application.css"/> <link rel=stylesheet  href="../_static/stylesheets/application-palette.css"/> <link rel=stylesheet  href="../_static/stylesheets/application-fixes.css"/> <link rel=stylesheet  href="../_static/fonts/material-icons.css"/> <meta name=theme-color  content="#3f51b5"> <script src="../_static/javascripts/modernizr.js"></script> <title>钛合金中的\(\beta\rightarrow\alpha\)相变 &#8212; microTi documentation</title> <link rel=stylesheet  type="text/css" href="../_static/pygments.css?v=83e35b93" /> <link rel=stylesheet  type="text/css" href="../_static/material.css?v=79c92029" /> <link rel=stylesheet  type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" /> <script src="../_static/documentation_options.js?v=5929fcd5"></script> <script src="../_static/doctools.js?v=9a2dae69"></script> <script src="../_static/sphinx_highlight.js?v=dc90522c"></script> <script crossorigin=anonymous  integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script> <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script> <script defer=defer  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script> <link rel=icon  href="../_static/pets.ico"/> <link rel=index  title=Index  href="../genindex.html" /> <link rel=search  title=Search  href="../search.html" /> <body dir=ltr data-md-color-primary=blue-grey data-md-color-accent=blue> <svg class=md-svg > <defs data-children-count=0 > <svg xmlns="http://www.w3.org/2000/svg" width=416  height=448  viewBox="0 0 416 448" id=__github ><path fill=currentColor  d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg> </defs> </svg> <input class=md-toggle  data-md-toggle=drawer  type=checkbox  id=__drawer > <input class=md-toggle  data-md-toggle=search  type=checkbox  id=__search > <label class=md-overlay  data-md-component=overlay  for=__drawer ></label> <a href="#other/burgers" tabindex=1  class=md-skip > Skip to content </a> <header class=md-header  data-md-component=header > <nav class="md-header-nav md-grid"> <div class="md-flex navheader"> <div class="md-flex__cell md-flex__cell--shrink"> <a href="../index.html" title="microTi documentation" class="md-header-nav__button md-logo"> <i class=md-icon >&#xE91D</i> </a> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--menu md-header-nav__button" for=__drawer ></label> </div> <div class="md-flex__cell md-flex__cell--stretch"> <div class="md-flex__ellipsis md-header-nav__title" data-md-component=title > <span class=md-header-nav__topic >microTi</span> <span class=md-header-nav__topic > 钛合金中的\(\beta\rightarrow\alpha\)相变 </span> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--search md-header-nav__button" for=__search ></label> <div class=md-search  data-md-component=search  role=dialog > <label class=md-search__overlay  for=__search ></label> <div class=md-search__inner  role=search > <form class=md-search__form  action="../search.html" method=get  name=search > <input type=text  class=md-search__input  name=q  placeholder=""Search"" autocapitalize=off  autocomplete=off  spellcheck=false  data-md-component=query  data-md-state=active > <label class="md-icon md-search__icon" for=__search ></label> <button type=reset  class="md-icon md-search__icon" data-md-component=reset  tabindex=-1 > &#xE5CD; </button> </form> <div class=md-search__output > <div class=md-search__scrollwrap  data-md-scrollfix> <div class=md-search-result  data-md-component=result > <div class=md-search-result__meta > Type to start searching </div> <ol class=md-search-result__list ></ol> </div> </div> </div> </div> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <div class=md-header-nav__source > <a href="https://github.com/vacuumserval/vacuumserval.github.io" title="Go to repository" class=md-source  data-md-source=github > <div class=md-source__icon > <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width=28  height=28 > <use xlink:href="#__github" width=24  height=24 ></use> </svg> </div> <div class=md-source__repository > microTi </div> </a> </div> </div> <script src="../_static/javascripts/version_dropdown.js"></script> <script> var json_loc = "../"versions.json"", target_loc = "../../", text = "Versions"; $( document ).ready( add_version_dropdown(json_loc, target_loc, text)); </script> </div> </nav> </header> <div class=md-container > <nav class=md-tabs  data-md-component=tabs > <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list > <li class=md-tabs__item ><a href="../index.html" class=md-tabs__link >microTi documentation</a> </ul> </div> </nav> <main class=md-main > <div class="md-main__inner md-grid" data-md-component=container > <div class="md-sidebar md-sidebar--primary" data-md-component=navigation > <div class=md-sidebar__scrollwrap > <div class=md-sidebar__inner > <nav class="md-nav md-nav--primary" data-md-level=0 > <label class="md-nav__title md-nav__title--site" for=__drawer > <a href="../index.html" title="microTi documentation" class="md-nav__button md-logo"> <i class=md-icon >&#xE91D</i> </a> <a href="../index.html" title="microTi documentation">microTi</a> </label> <div class=md-nav__source > <a href="https://github.com/vacuumserval/vacuumserval.github.io" title="Go to repository" class=md-source  data-md-source=github > <div class=md-source__icon > <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width=28  height=28 > <use xlink:href="#__github" width=24  height=24 ></use> </svg> </div> <div class=md-source__repository > microTi </div> </a> </div> <ul class=md-nav__list > <li class=md-nav__item > <span class="md-nav__link caption"><span class=caption-text >Infrastructure</span></span> <li class=md-nav__item > <a href="../infrastructure/linux.html" class=md-nav__link >Linux</a> <li class=md-nav__item > <span class="md-nav__link caption"><span class=caption-text >Phase Field Method</span></span> <li class=md-nav__item > <a href="../phasefield/spinodal.html" class=md-nav__link >Spinodal Decomposition</a> <li class=md-nav__item > <a href="../phasefield/burgers.html" class=md-nav__link >钛合金中的<span class="math notranslate nohighlight">\(\beta\rightarrow\alpha\)</span>相变</a> <li class=md-nav__item > <a href="../phasefield/pfc.html" class=md-nav__link >Phase Field Crystal</a> <li class=md-nav__item > <a href="../phasefield/hexsq.html" class=md-nav__link >PFC: <span class="math notranslate nohighlight">\(\bigtriangleup \leftrightarrow \square\)</span></a> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc > <div class=md-sidebar__scrollwrap > <div class=md-sidebar__inner > <nav class="md-nav md-nav--secondary"> <label class=md-nav__title  for=__toc >"Contents"</label> <ul class=md-nav__list  data-md-scrollfix=""> <li class=md-nav__item ><a href="#other-burgers--page-root" class=md-nav__link >钛合金中的<span class="math notranslate nohighlight">\(\beta\rightarrow\alpha\)</span>相变</a><nav class=md-nav > <ul class=md-nav__list > <li class=md-nav__item ><a href="#Burgers取向关系" class=md-nav__link >Burgers取向关系</a><nav class=md-nav > <ul class=md-nav__list > <li class=md-nav__item ><a href="#马氏体相变(Martensite-Transformation,-MT)相场模型" class=md-nav__link >马氏体相变(Martensite Transformation, MT)相场模型</a> </ul> </nav> </ul> </nav> <li class=md-nav__item ><a class=md-nav__extra_link  href="../_sources/other/burgers.ipynb.txt">Show Source</a> <li id=searchbox  class=md-nav__item > </ul> </nav> </div> </div> </div> <div class=md-content > <article class="md-content__inner md-typeset" role=main > <section id="钛合金中的\beta\rightarrow\alpha相变"> <h1 id=other-burgers--page-root >钛合金中的<span class="math notranslate nohighlight">\(\beta\rightarrow\alpha\)</span>相变<a class=headerlink  href="#other-burgers--page-root" title="Link to this heading">¶</a></h1> <p>参考文献：</p> <p>[1] <em>XIANG H, VAN PAEPEGEM W, KESTENS L A I. Study of Microstructural Morphology of Ti-6Al-4V Alloy by Crystallographic Analysis and Phase Field Simulation[J/OL]. Materials, 2022, 15(15): 5325. DOI:10.3390/ma15155325.</em></p> <p>[2] <em>SHI R, MA N, WANG Y. Predicting equilibrium shape of precipitates as function of coherency state[J/OL]. Acta Materialia, 2012, 60(10): 4172-4184. DOI:10.1016/j.actamat.2012.04.019.</em></p> <p>[3] <em>GAO Y, ZHOU N, WANG D, 等. Pattern formation during cubic to orthorhombic martensitic transformations in shape memory alloys[J/OL]. Acta Materialia, 2014, 68: 93-105. DOI:10.1016/j.actamat.2014.01.012.</em></p> <p>[4] <em>邱嫡.α/β钛合金晶体缺陷附近α相析出机制的相场法研究[D].上海交通大学,2016.</em></p> <section id="Burgers取向关系"> <h2 id="Burgers取向关系">Burgers取向关系<a class=headerlink  href="#Burgers取向关系" title="Link to this heading">¶</a></h2> <p>在钛合金中，最常见的是<span class="math notranslate nohighlight">\(\beta\)</span>相和<span class="math notranslate nohighlight">\(\alpha\)</span>相之间的转变。<span class="math notranslate nohighlight">\(\beta\)</span>相具有立方结构，而<span class="math notranslate nohighlight">\(\alpha\)</span>相具有密排六方结构。在<span class="math notranslate nohighlight">\(\beta\)</span>相转变为<span class="math notranslate nohighlight">\(\alpha\)</span>相的过程中，存在一种特定的取向关系，即Burgers取向关系，这种关系的具体表达式是</p> <div class="math notranslate nohighlight"> \[\begin{split}\begin{align} x_o\parallel [100] \parallel [1\bar{1}0]_\beta &amp;\parallel [0001]_\alpha \\ y_o\parallel [010] \parallel [110]_\beta &amp;\parallel [10\bar{1}0]_\alpha \\ z_o\parallel [001] \parallel [001]_\beta &amp;\parallel [\bar{1}2\bar{1}0]_\alpha \end{align}\end{split}\]</div> <p>这意味着在<span class="math notranslate nohighlight">\(\beta\)</span>相晶粒内，可能会出现12个不同取向的<span class="math notranslate nohighlight">\(\alpha\)</span>相变体。</p> <p><img alt=p1  class=no-scaled-link  src="https://www.mdpi.com/materials/materials-15-05325/article_deploy/html/images/materials-15-05325-g001.png" style="width: 400px;"/></p> <p>这种取向关系的存在对钛合金的力学性能有重要影响。例如，它影响了合金的强度、塑性和疲劳性能。因此，理解并控制这种变体选择过程是提高钛合金性能的关键。目前，关于钛合金中Burgers取向关系的研究仍在进行中，特别是关于如何在相变过程中控制和减弱变体选择的发生，这被认为是进一步提高钛合金性能的潜在方法之一。</p> <p><img alt=p1  class=no-scaled-link  src="other/image/burgersog.png" style="width: 400px;"/> [2]</p> <p>具体到原子来看，就是要求BCC结构（灰色）原子，和HCP结构（蓝色）原子在三个正交方向上重合，转移矩阵为<span class="math notranslate nohighlight">\(F_{tot}\)</span>，BCC到HCP的转换的数学表示为<span class="math notranslate nohighlight">\(\mathbf{r}_\alpha=F_{tot}\mathbf{r}_\beta\)</span>。这需要通过压缩/拉伸变形(e, <span class="math notranslate nohighlight">\(F_1\)</span>)+旋转(f, <span class="math notranslate nohighlight">\(R\)</span>)来实现。</p> <ul> <li><p>先进行压缩/拉伸：</p> <ul class=simple > <li><p>沿着<span class="math notranslate nohighlight">\([010]_\beta\)</span>方向，即<span class="math notranslate nohighlight">\([\bar{1}2\bar{1}0]_\alpha\)</span>方向，BCC和HCP的两套格子的原子最近临间距分别为<span class="math notranslate nohighlight">\(a_\beta \Leftrightarrow a_\alpha\)</span>;</p> <li><p>沿着<span class="math notranslate nohighlight">\([\bar{1}01]_\beta\)</span>方向，即<span class="math notranslate nohighlight">\([\bar{1}0\bar{1}0]_\alpha\)</span>方向，BCC和HCP的两套格子的原子最近临间距分别为<span class="math notranslate nohighlight">\(\sqrt{2}a_\beta \Leftrightarrow \sqrt{3}a_\alpha\)</span>;</p> <li><p>沿着<span class="math notranslate nohighlight">\([101]_\beta\)</span>方向，即<span class="math notranslate nohighlight">\([0001]_\alpha\)</span>方向，BCC和HCP的两套格子的原子最近临间距分别为<span class="math notranslate nohighlight">\(\sqrt{2}a_\beta \Leftrightarrow c_\alpha\)</span>;</p> </ul> <p>因此压缩/拉伸变形转移矩阵<span class="math notranslate nohighlight">\(F_1\)</span>为</p> <div class="math notranslate nohighlight"> \[\begin{split}\begin{align} F_1 = \begin{pmatrix} a_\alpha / a_\beta &amp; 0 &amp; 0 \\ 0 &amp; \sqrt{3}a_\alpha/\sqrt{2}a_\beta &amp; 0 \\ 0 &amp; 0 &amp; c_\alpha/\sqrt{2}a_\beta \end{pmatrix} \end{align}\end{split}\]</div> <li><p>再进行<span class="math notranslate nohighlight">\(\frac{70.5\degree-60\degree}{2}\approx 5.25\degree\)</span>的旋转，旋转矩阵<span class="math notranslate nohighlight">\(R\)</span>为</p> <div class="math notranslate nohighlight"> \[\begin{split}\begin{align} R = \begin{pmatrix} cos(5.25\degree) &amp; sin(5.25\degree) &amp; 0 \\ -sin(5.25\degree) &amp; cos(5.25\degree) &amp; 0 \\ 0 &amp; 0 &amp; 1 \end{pmatrix} \end{align}\end{split}\]</div> </ul> <p>转移矩阵为<span class="math notranslate nohighlight">\(F_{tot}=RF_1\)</span>，全部12种变体的转移矩阵可以通过对称性获得。</p> <p>钛合金中的马氏体相<span class="math notranslate nohighlight">\(\alpha'\)</span>也是HCP结构的，马氏体相变通常是从高温的<span class="math notranslate nohighlight">\(\beta\)</span>相（体心立方结构，BCC）通过快速冷却，转变为<span class="math notranslate nohighlight">\(\alpha'\)</span>马氏体相（密排六方结构，HCP）的过程。马氏体相变不涉及原子扩散，而是通过原子重新排列来形成。<em>Theoretically, unlike diffusion transformations, martensitic transformations (also known as displacive transformations) involve short-range atomic displacements, which result in a change of crystal structure with minimum transformation elastic strain energy. Based on the Burgers orientation correspondence, for the martensitic transformation of Ti-6Al-4V alloy, the lattice orthohexagonal reference system between BCC and HCP cells is shown in Figure 1</em> [1] - 理论上，与扩散型相变不同，马氏体相变涉及短程原子位移，这导致晶体结构发生变化，同时使变形弹性应变能最小化。对于马氏体相变，论文[1]指出<em>Theoretically, the atomic shuffle is necessary for phase transformation between BCC and HCP crystallographic structures through dislocation glide [52–54]. Therefore, in the current work, without considering the internal shuffle, only six correspondence variants from a single parent beta grain are produced (in order to distinguish from the 12 crystallographic variants in which the dislocation glide is under consideration, the phrase ‘correspondence variant’ is used, and ‘variant’ refers to the correspondence variant without specifying the ‘crystallographic variants’).</em> - 理论上，原子重排对于通过位错滑移在BCC（体心立方）和HCP（六方密排）晶体结构之间进行相变是必要的。因此，在当前工作中，没有考虑内部重排，仅从单一母β晶粒产生了6个对应变体（为了与考虑位错滑移时的12个晶体学变体相区分，这里使用了“对应变体”这个术语，而“变体”指的是不考虑“晶体学变体”的对应变体）。我的理解（不一定对）这就意味着，在论文[1]马氏体的建模中，就没有滑移引起的那个旋转矩阵，而是只有压缩/拉伸矩阵了。另一方面，[1]与[2]选取了不同的正交坐标系方向，为方便后续编程参考，在此采取[1]的坐标选取法和对应变体指定法，即</p> <ul class=simple > <li><p>变形矩阵<span class="math notranslate nohighlight">\(U_o\)</span></p> </ul> <div class="math notranslate nohighlight"> \[\begin{split}\begin{align} \mathbf{U}_o = \begin{pmatrix} \gamma=c_\alpha/\sqrt{2}a_\beta &amp; 0 &amp; 0 \\ 0 &amp; \alpha=\sqrt{3}a_\alpha/\sqrt{2}a_\beta &amp; 0 \\ 0 &amp; 0 &amp; \beta=a_\alpha / a_\beta \end{pmatrix} \end{align}\end{split}\]</div> <p>注意到不同成分和热处理制度钛合金<span class="math notranslate nohighlight">\(\alpha\)</span>和<span class="math notranslate nohighlight">\(\beta\)</span>相的晶格常数不同，这就使得模型具有了建模不同钛合金的能力。<em>Applying the Cauchy–Born Hypothesis that links the lattice to the continuum, the transformation matrix of variant 1 can be identified as</em> [3] - 根据Cauchy–Born假设，将晶格与连续体相联系，变体1的变换矩阵可以被定义为</p> <div class="math notranslate nohighlight"> \[\begin{split}\begin{align} \mathbf{U}_p = \begin{pmatrix} \frac{\alpha+\gamma}{2} &amp; \frac{\alpha-\gamma}{2} &amp; 0 \\ \frac{\alpha-\gamma}{2} &amp; \frac{\alpha+\gamma}{2} &amp; 0 \\ 0 &amp; 0 &amp; \beta \end{pmatrix} \end{align}\end{split}\]</div> <p>对于论文[1]的钛合金，晶格常数<span class="math notranslate nohighlight">\(a_\beta=3.3065\AA\)</span>，<span class="math notranslate nohighlight">\(a_\alpha=2.9511\AA\)</span>，<span class="math notranslate nohighlight">\(c_\alpha=4.6843\AA\)</span>。</p> <div class="nbinput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[1]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=kn >import</span> <span class=nn >numpy</span> <span class=k >as</span> <span class=nn >np</span>
<span class=k >def</span> <span class=nf >Ucal</span><span class=p >(</span><span class=n >a_beta</span><span class=p >,</span> <span class=n >a_alpha</span><span class=p >,</span> <span class=n >c_alpha</span><span class=p >):</span> <span class=c1 ># 计算变换矩阵(3D,3D,6variant)</span>
    <span class=n >U</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >zeros</span><span class=p >((</span><span class=mi >3</span><span class=p >,</span><span class=mi >3</span><span class=p >,</span><span class=mi >6</span><span class=p >))</span> <span class=c1 ># 变换矩阵(3D,3D,6variant)</span>
    <span class=n >gamma</span> <span class=o >=</span> <span class=n >c_alpha</span> <span class=o >/</span> <span class=p >(</span><span class=n >np</span><span class=o >.</span><span class=n >sqrt</span><span class=p >(</span><span class=mi >2</span><span class=p >)</span><span class=o >*</span><span class=n >a_beta</span><span class=p >)</span>
    <span class=n >alpha</span> <span class=o >=</span> <span class=p >(</span><span class=n >np</span><span class=o >.</span><span class=n >sqrt</span><span class=p >(</span><span class=mi >3</span><span class=p >)</span><span class=o >*</span><span class=n >a_alpha</span><span class=p >)</span><span class=o >/</span><span class=p >(</span><span class=n >np</span><span class=o >.</span><span class=n >sqrt</span><span class=p >(</span><span class=mi >2</span><span class=p >)</span><span class=o >*</span><span class=n >a_beta</span><span class=p >)</span>
    <span class=n >beta</span> <span class=o >=</span> <span class=n >a_alpha</span> <span class=o >/</span> <span class=n >a_beta</span>
    <span class=n >u11</span> <span class=o >=</span> <span class=mf >0.5</span><span class=o >*</span><span class=p >(</span><span class=n >alpha</span><span class=o >+</span><span class=n >gamma</span><span class=p >)</span>
    <span class=n >u12</span> <span class=o >=</span> <span class=mf >0.5</span><span class=o >*</span><span class=p >(</span><span class=n >alpha</span><span class=o >-</span><span class=n >gamma</span><span class=p >)</span>
    <span class=n >u33</span> <span class=o >=</span> <span class=n >beta</span>
    <span class=n >U</span><span class=p >[:,:,</span><span class=mi >5</span><span class=p >]</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >array</span><span class=p >([[</span><span class=n >u11</span><span class=p >,</span> <span class=n >u12</span><span class=p >,</span> <span class=mi >0</span><span class=p >],</span>\
                   <span class=p >[</span><span class=n >u12</span><span class=p >,</span> <span class=n >u11</span><span class=p >,</span> <span class=mi >0</span><span class=p >],</span>\
                    <span class=p >[</span><span class=mi >0</span><span class=p >,</span> <span class=mi >0</span><span class=p >,</span> <span class=n >u33</span><span class=p >]])</span>
    <span class=n >U</span><span class=p >[:,:,</span><span class=mi >4</span><span class=p >]</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >array</span><span class=p >([[</span><span class=n >u11</span><span class=p >,</span> <span class=o >-</span><span class=n >u12</span><span class=p >,</span> <span class=mi >0</span><span class=p >],</span>\
                   <span class=p >[</span><span class=o >-</span><span class=n >u12</span><span class=p >,</span> <span class=n >u11</span><span class=p >,</span> <span class=mi >0</span><span class=p >],</span>\
                    <span class=p >[</span><span class=mi >0</span><span class=p >,</span> <span class=mi >0</span><span class=p >,</span> <span class=n >u33</span><span class=p >]])</span>
    <span class=n >U</span><span class=p >[:,:,</span><span class=mi >3</span><span class=p >]</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >array</span><span class=p >([[</span><span class=n >u11</span><span class=p >,</span> <span class=mi >0</span><span class=p >,</span> <span class=n >u12</span><span class=p >],</span>\
                   <span class=p >[</span><span class=mi >0</span><span class=p >,</span> <span class=n >u33</span><span class=p >,</span> <span class=mi >0</span><span class=p >],</span>\
                    <span class=p >[</span><span class=n >u12</span><span class=p >,</span> <span class=mi >0</span><span class=p >,</span> <span class=n >u11</span><span class=p >]])</span>
    <span class=n >U</span><span class=p >[:,:,</span><span class=mi >2</span><span class=p >]</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >array</span><span class=p >([[</span><span class=n >u11</span><span class=p >,</span> <span class=mi >0</span><span class=p >,</span> <span class=o >-</span><span class=n >u12</span><span class=p >],</span>\
                   <span class=p >[</span><span class=mi >0</span><span class=p >,</span> <span class=n >u33</span><span class=p >,</span> <span class=mi >0</span><span class=p >],</span>\
                    <span class=p >[</span><span class=o >-</span><span class=n >u12</span><span class=p >,</span> <span class=mi >0</span><span class=p >,</span> <span class=n >u11</span><span class=p >]])</span>
    <span class=n >U</span><span class=p >[:,:,</span><span class=mi >1</span><span class=p >]</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >array</span><span class=p >([[</span><span class=n >u33</span><span class=p >,</span> <span class=mi >0</span><span class=p >,</span> <span class=mi >0</span><span class=p >],</span>\
                   <span class=p >[</span><span class=mi >0</span><span class=p >,</span> <span class=n >u11</span><span class=p >,</span> <span class=n >u12</span><span class=p >],</span>\
                    <span class=p >[</span><span class=mi >0</span><span class=p >,</span> <span class=n >u12</span><span class=p >,</span> <span class=n >u11</span><span class=p >]])</span>
    <span class=n >U</span><span class=p >[:,:,</span><span class=mi >0</span><span class=p >]</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >array</span><span class=p >([[</span><span class=n >u33</span><span class=p >,</span> <span class=mi >0</span><span class=p >,</span> <span class=mi >0</span><span class=p >],</span>\
                   <span class=p >[</span><span class=mi >0</span><span class=p >,</span> <span class=n >u11</span><span class=p >,</span> <span class=o >-</span><span class=n >u12</span><span class=p >],</span>\
                    <span class=p >[</span><span class=mi >0</span><span class=p >,</span> <span class=o >-</span><span class=n >u12</span><span class=p >,</span> <span class=n >u11</span><span class=p >]])</span>
    <span class=k >return</span><span class=p >(</span><span class=n >U</span><span class=p >)</span>
<span class=n >ab</span> <span class=o >=</span> <span class=mf >3.3065</span>
<span class=n >aa</span> <span class=o >=</span> <span class=mf >2.9511</span>
<span class=n >ca</span> <span class=o >=</span> <span class=mf >4.6843</span>
</pre></div> </div> </div> <section id="马氏体相变(Martensite-Transformation,-MT)相场模型"> <h3 id="马氏体相变(Martensite-Transformation,-MT)相场模型">马氏体相变(Martensite Transformation, MT)相场模型<a class=headerlink  href="#马氏体相变(Martensite-Transformation,-MT)相场模型" title="Link to this heading">¶</a></h3> <p><em>During martensitic transformation, the change of lattice structure leads to transformation deformation. The SFTS can be calculated with following equation</em> [1] - 在马氏体相变过程中，晶格结构的变化导致相变变形。形状变化引起的特征应变（SFTS）可以通过以下方程计算得出。</p> <div class="math notranslate nohighlight"> \[\begin{align} \varepsilon_{ij}^{00}(p)=\frac{\mathbf{U}_p'\mathbf{U}_p-\mathbf{I}}{2} \end{align}\]</div> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[2]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=kn >import</span> <span class=nn >numpy</span> <span class=k >as</span> <span class=nn >np</span>

<span class=k >def</span> <span class=nf >e2cal</span><span class=p >(</span><span class=n >U</span><span class=p >):</span> <span class=c1 ># 计算特征应变(3D,3D,6variant)</span>
    <span class=n >e2</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >zeros</span><span class=p >((</span><span class=mi >3</span><span class=p >,</span><span class=mi >3</span><span class=p >,</span><span class=mi >6</span><span class=p >))</span> <span class=c1 ># 特征应变(3D,3D,6variant)</span>
    <span class=k >for</span> <span class=n >p</span> <span class=ow >in</span> <span class=nb >range</span><span class=p >(</span><span class=mi >6</span><span class=p >):</span>
        <span class=n >e2</span><span class=p >[:,:,</span><span class=n >p</span><span class=p >]</span> <span class=o >=</span> <span class=p >(</span><span class=n >np</span><span class=o >.</span><span class=n >matmul</span><span class=p >(</span><span class=n >np</span><span class=o >.</span><span class=n >transpose</span><span class=p >(</span><span class=n >U</span><span class=p >[:,:,</span><span class=n >p</span><span class=p >]),</span> <span class=n >U</span><span class=p >[:,:,</span><span class=n >p</span><span class=p >])</span><span class=o >-</span><span class=n >np</span><span class=o >.</span><span class=n >eye</span><span class=p >(</span><span class=mi >3</span><span class=p >))</span><span class=o >/</span><span class=mi >2</span>
    <span class=k >return</span><span class=p >(</span><span class=n >e2</span><span class=p >)</span>

<span class=n >ab</span> <span class=o >=</span> <span class=mf >3.3065</span>
<span class=n >aa</span> <span class=o >=</span> <span class=mf >2.9511</span>
<span class=n >ca</span> <span class=o >=</span> <span class=mf >4.6843</span>

<span class=n >U</span> <span class=o >=</span> <span class=n >Ucal</span><span class=p >(</span><span class=n >a_beta</span><span class=o >=</span><span class=n >ab</span><span class=p >,</span> <span class=n >a_alpha</span><span class=o >=</span><span class=n >aa</span><span class=p >,</span> <span class=n >c_alpha</span><span class=o >=</span><span class=n >ca</span><span class=p >)</span>
<span class=n >e2</span> <span class=o >=</span> <span class=n >e2cal</span><span class=p >(</span><span class=n >U</span><span class=o >=</span><span class=n >U</span><span class=p >)</span>
<span class=k >for</span> <span class=n >p</span> <span class=ow >in</span> <span class=nb >range</span><span class=p >(</span><span class=mi >6</span><span class=p >):</span>
    <span class=nb >print</span><span class=p >(</span><span class=s1 >'U_'</span><span class=p >,</span><span class=nb >str</span><span class=p >(</span><span class=n >p</span><span class=o >+</span><span class=mi >1</span><span class=p >),</span><span class=s1 >'='</span><span class=p >,</span> <span class=n >U</span><span class=p >[:,:,</span><span class=n >p</span><span class=p >])</span>
    <span class=nb >print</span><span class=p >(</span><span class=s1 >'e_'</span><span class=p >,</span><span class=nb >str</span><span class=p >(</span><span class=n >p</span><span class=o >+</span><span class=mi >1</span><span class=p >),</span><span class=s1 >'='</span><span class=p >,</span> <span class=n >e2</span><span class=p >[:,:,</span><span class=n >p</span><span class=p >])</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
U_ 1 = [[ 0.89251474  0.          0.        ]
 [ 0.          1.04742853 -0.04567432]
 [ 0.         -0.04567432  1.04742853]]
e_ 1 = [[-0.10170872  0.          0.        ]
 [ 0.          0.04959634 -0.04784059]
 [ 0.         -0.04784059  0.04959634]]
U_ 2 = [[0.89251474 0.         0.        ]
 [0.         1.04742853 0.04567432]
 [0.         0.04567432 1.04742853]]
e_ 2 = [[-0.10170872  0.          0.        ]
 [ 0.          0.04959634  0.04784059]
 [ 0.          0.04784059  0.04959634]]
U_ 3 = [[ 1.04742853  0.         -0.04567432]
 [ 0.          0.89251474  0.        ]
 [-0.04567432  0.          1.04742853]]
e_ 3 = [[ 0.04959634  0.         -0.04784059]
 [ 0.         -0.10170872  0.        ]
 [-0.04784059  0.          0.04959634]]
U_ 4 = [[1.04742853 0.         0.04567432]
 [0.         0.89251474 0.        ]
 [0.04567432 0.         1.04742853]]
e_ 4 = [[ 0.04959634  0.          0.04784059]
 [ 0.         -0.10170872  0.        ]
 [ 0.04784059  0.          0.04959634]]
U_ 5 = [[ 1.04742853 -0.04567432  0.        ]
 [-0.04567432  1.04742853  0.        ]
 [ 0.          0.          0.89251474]]
e_ 5 = [[ 0.04959634 -0.04784059  0.        ]
 [-0.04784059  0.04959634  0.        ]
 [ 0.          0.         -0.10170872]]
U_ 6 = [[1.04742853 0.04567432 0.        ]
 [0.04567432 1.04742853 0.        ]
 [0.         0.         0.89251474]]
e_ 6 = [[ 0.04959634  0.04784059  0.        ]
 [ 0.04784059  0.04959634  0.        ]
 [ 0.          0.         -0.10170872]]
</pre></div></div> </div> <p>有些文献（如[4]），应变张量的求法略有不同。</p> <div class="math notranslate nohighlight"> \[\begin{align} \varepsilon_{ij}^{00}(p)=\frac{\mathbf{U}_p'+\mathbf{U}_p}{2}-\mathbf{I} \end{align}\]</div> <p>无论哪种定义法，总之都是给应变增加了一定的各项异性。</p> <p>系统的自由能泛函[1]建模为：</p> <div class="math notranslate nohighlight"> \[\begin{align} F = \int\left(F^{ch}+F^{grad}\right)d^3\mathbf{r} + F^{el} \end{align}\]</div> <p>其中，化学能泛函<span class="math notranslate nohighlight">\(F^{ch}\)</span>是Landau多项式形式的：</p> <div class="math notranslate nohighlight"> \[\begin{align} F^{ch} = \frac{1}{V_m}\left[\frac{A}{2}\sum_{p=1}^6\eta_p^2-\frac{B}{3}\sum_{p=1}\eta_p^3+\frac{C}{4}\left(\sum_{p=1}^6\eta_p^2\right)^2\right] \end{align}\]</div> <p>界面能泛函<span class="math notranslate nohighlight">\(F^{grad}\)</span>是梯度场形式的（这里[1]论文写的不甚清楚，代码上反推是这样）：</p> <div class="math notranslate nohighlight"> \[\begin{align} F^{grad} = \frac{1}{V_m}\left[\sum_{p=1}^6\frac{\kappa}{2}\left(\nabla\eta_p\right)^2\right] \end{align}\]</div> <p>弹性应变能<span class="math notranslate nohighlight">\(F^{el}\)</span>可以根据KS理论进行公式化表达：</p> <div class="math notranslate nohighlight"> \[\begin{align} F^{el} = \frac{1}{2}\sum_{p=1}^{6}\oint\frac{d^3\mathbf{k}}{(2\pi)^3}B_{pq}(\mathbf{n})\{\hat{\eta}_p\}_k\{\hat{\eta}_q\}_k^* \end{align}\]</div> <p>其中积分是在倒易空间中进行的，<span class="math notranslate nohighlight">\(\mathbf{k}\)</span>是倒易空间中的一个矢量，<span class="math notranslate nohighlight">\(\mathbf{n}=\mathbf{k}/|k|\)</span>是倒易空间中的单位矢量。注意，积分中要排除<span class="math notranslate nohighlight">\(k = 0\)</span>的情况。<span class="math notranslate nohighlight">\(\{\hat{\eta}_p\}_k\)</span>是<span class="math notranslate nohighlight">\(\eta(\mathbf{r})\)</span>的傅里叶变换，其中<span class="math notranslate nohighlight">\(\mathbf{r}\)</span>是实空间中的矢量。星号表示复共轭。考虑一个具有限定（即固定）外部边界（零应变条件）的系统， <span class="math notranslate nohighlight">\(B_{pq}(\mathbf{n})\)</span>的形式为：</p> <div class="math notranslate nohighlight"> \[\begin{split}\begin{align} B_{pq}(\mathbf{n}) = \begin{cases} C_{ijkl}\varepsilon_{ij}(p)\varepsilon_{kl}(q) \;\; &amp;\; \mathbf{n}=0 \\ C_{ijkl}\varepsilon_{ij}(p)\varepsilon_{kl}(q)-n_i\sigma_{ij}^p\Omega_{jk}\sigma_{kl}^qn_l \;\; &amp;\; \mathbf{n}\neq 0 \end{cases} \end{align}\end{split}\]</div> <p>其中<span class="math notranslate nohighlight">\(C_{ijkl}\)</span>是弹性刚度张量，在均匀模拟系统中，假设其<span class="math notranslate nohighlight">\(\alpha\)</span>相和<span class="math notranslate nohighlight">\(\beta\)</span>相的组分相同，并且是各向同性的，大部分文献采用<span class="math notranslate nohighlight">\(\alpha\)</span>相的<span class="math notranslate nohighlight">\(C_{ijkl}\)</span>。在Voigt表示法中，四阶弹性张量<span class="math notranslate nohighlight">\(C_{ijkl}\)</span>的独立分量被映射到二阶弹性张量<span class="math notranslate nohighlight">\(C_{ij}\)</span>的6个独立分量，如下所示：</p> <div class="math notranslate nohighlight"> \[\begin{split}\begin{align} C_{11} &amp;\Leftrightarrow C_{1111} \\ C_{22} &amp;\Leftrightarrow C_{2222} \\ C_{33} &amp;\Leftrightarrow C_{3333} \\ C_{12}=C_{21} &amp;\Leftrightarrow C_{1122} \\ C_{13}=C_{31} &amp;\Leftrightarrow C_{1133} \\ C_{23}=C_{32} &amp;\Leftrightarrow C_{2233} \end{align}\end{split}\]</div> <p>此外，还有三个剪切模量，它们是：</p> <div class="math notranslate nohighlight"> \[\begin{split}\begin{align} C_{44} &amp;\Leftrightarrow C_{1212}\; \text{or} \; C_{2323} \\ C_{55} &amp;\Leftrightarrow C_{1313} \\ C_{66} &amp;\Leftrightarrow C_{1212}=C_{1313}=C_{2323} \end{align}\end{split}\]</div> <p>论文[1]中的弹性常数<span class="math notranslate nohighlight">\(C_{11}=97.7GPa\)</span>，<span class="math notranslate nohighlight">\(C_{12}=82.7GPa\)</span>，<span class="math notranslate nohighlight">\(C_{44}=7.5GPa\)</span>，相场方法使用时应除以<span class="math notranslate nohighlight">\(\frac{\Delta G_m}{V_{mol}}=\frac{3.1375e02 J/mol}{1e-5 m^3/mol}\)</span>以无量纲化。</p> <div class="nbinput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[3]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=kn >import</span> <span class=nn >numpy</span> <span class=k >as</span> <span class=nn >np</span>

<span class=k >def</span> <span class=nf >C4cal</span><span class=p >(</span><span class=n >c11</span><span class=p >,</span> <span class=n >c12</span><span class=p >,</span> <span class=n >c44</span><span class=p >):</span> <span class=c1 ># 计算四阶弹性张量(3D,3D,3D,3D)</span>
    <span class=n >C4</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >zeros</span><span class=p >((</span><span class=mi >3</span><span class=p >,</span><span class=mi >3</span><span class=p >,</span><span class=mi >3</span><span class=p >,</span><span class=mi >3</span><span class=p >))</span> <span class=c1 ># 四阶弹性张量(3D,3D,3D,3D)</span>
    <span class=n >C4</span><span class=p >[</span><span class=mi >0</span><span class=p >,</span><span class=mi >0</span><span class=p >,</span><span class=mi >0</span><span class=p >,</span><span class=mi >0</span><span class=p >]</span> <span class=o >=</span> <span class=n >c11</span><span class=p >;</span> <span class=n >C4</span><span class=p >[</span><span class=mi >1</span><span class=p >,</span><span class=mi >1</span><span class=p >,</span><span class=mi >1</span><span class=p >,</span><span class=mi >1</span><span class=p >]</span> <span class=o >=</span> <span class=n >c11</span><span class=p >;</span> <span class=n >C4</span><span class=p >[</span><span class=mi >2</span><span class=p >,</span><span class=mi >2</span><span class=p >,</span><span class=mi >2</span><span class=p >,</span><span class=mi >2</span><span class=p >]</span> <span class=o >=</span> <span class=n >c11</span><span class=p >;</span>
    <span class=n >C4</span><span class=p >[</span><span class=mi >0</span><span class=p >,</span><span class=mi >0</span><span class=p >,</span><span class=mi >1</span><span class=p >,</span><span class=mi >1</span><span class=p >]</span> <span class=o >=</span> <span class=n >c12</span><span class=p >;</span> <span class=n >C4</span><span class=p >[</span><span class=mi >1</span><span class=p >,</span><span class=mi >1</span><span class=p >,</span><span class=mi >2</span><span class=p >,</span><span class=mi >2</span><span class=p >]</span> <span class=o >=</span> <span class=n >c12</span><span class=p >;</span> <span class=n >C4</span><span class=p >[</span><span class=mi >2</span><span class=p >,</span><span class=mi >2</span><span class=p >,</span><span class=mi >0</span><span class=p >,</span><span class=mi >0</span><span class=p >]</span> <span class=o >=</span> <span class=n >c12</span><span class=p >;</span>
    <span class=n >C4</span><span class=p >[</span><span class=mi >1</span><span class=p >,</span><span class=mi >1</span><span class=p >,</span><span class=mi >0</span><span class=p >,</span><span class=mi >0</span><span class=p >]</span> <span class=o >=</span> <span class=n >c12</span><span class=p >;</span> <span class=n >C4</span><span class=p >[</span><span class=mi >2</span><span class=p >,</span><span class=mi >2</span><span class=p >,</span><span class=mi >1</span><span class=p >,</span><span class=mi >1</span><span class=p >]</span> <span class=o >=</span> <span class=n >c12</span><span class=p >;</span> <span class=n >C4</span><span class=p >[</span><span class=mi >0</span><span class=p >,</span><span class=mi >0</span><span class=p >,</span><span class=mi >2</span><span class=p >,</span><span class=mi >2</span><span class=p >]</span> <span class=o >=</span> <span class=n >c12</span><span class=p >;</span>
    <span class=n >C4</span><span class=p >[</span><span class=mi >0</span><span class=p >,</span><span class=mi >1</span><span class=p >,</span><span class=mi >0</span><span class=p >,</span><span class=mi >1</span><span class=p >]</span> <span class=o >=</span> <span class=n >c44</span><span class=p >;</span> <span class=n >C4</span><span class=p >[</span><span class=mi >1</span><span class=p >,</span><span class=mi >2</span><span class=p >,</span><span class=mi >1</span><span class=p >,</span><span class=mi >2</span><span class=p >]</span> <span class=o >=</span> <span class=n >c44</span><span class=p >;</span> <span class=n >C4</span><span class=p >[</span><span class=mi >2</span><span class=p >,</span><span class=mi >0</span><span class=p >,</span><span class=mi >2</span><span class=p >,</span><span class=mi >0</span><span class=p >]</span> <span class=o >=</span> <span class=n >c44</span><span class=p >;</span>
    <span class=n >C4</span><span class=p >[</span><span class=mi >1</span><span class=p >,</span><span class=mi >0</span><span class=p >,</span><span class=mi >1</span><span class=p >,</span><span class=mi >0</span><span class=p >]</span> <span class=o >=</span> <span class=n >c44</span><span class=p >;</span> <span class=n >C4</span><span class=p >[</span><span class=mi >2</span><span class=p >,</span><span class=mi >1</span><span class=p >,</span><span class=mi >2</span><span class=p >,</span><span class=mi >1</span><span class=p >]</span> <span class=o >=</span> <span class=n >c44</span><span class=p >;</span> <span class=n >C4</span><span class=p >[</span><span class=mi >0</span><span class=p >,</span><span class=mi >2</span><span class=p >,</span><span class=mi >0</span><span class=p >,</span><span class=mi >2</span><span class=p >]</span> <span class=o >=</span> <span class=n >c44</span><span class=p >;</span>
    <span class=n >C4</span><span class=p >[</span><span class=mi >0</span><span class=p >,</span><span class=mi >1</span><span class=p >,</span><span class=mi >1</span><span class=p >,</span><span class=mi >0</span><span class=p >]</span> <span class=o >=</span> <span class=n >c44</span><span class=p >;</span> <span class=n >C4</span><span class=p >[</span><span class=mi >2</span><span class=p >,</span><span class=mi >1</span><span class=p >,</span><span class=mi >1</span><span class=p >,</span><span class=mi >2</span><span class=p >]</span> <span class=o >=</span> <span class=n >c44</span><span class=p >;</span> <span class=n >C4</span><span class=p >[</span><span class=mi >0</span><span class=p >,</span><span class=mi >2</span><span class=p >,</span><span class=mi >2</span><span class=p >,</span><span class=mi >0</span><span class=p >]</span> <span class=o >=</span> <span class=n >c44</span><span class=p >;</span>
    <span class=n >C4</span><span class=p >[</span><span class=mi >1</span><span class=p >,</span><span class=mi >0</span><span class=p >,</span><span class=mi >0</span><span class=p >,</span><span class=mi >1</span><span class=p >]</span> <span class=o >=</span> <span class=n >c44</span><span class=p >;</span> <span class=n >C4</span><span class=p >[</span><span class=mi >1</span><span class=p >,</span><span class=mi >2</span><span class=p >,</span><span class=mi >2</span><span class=p >,</span><span class=mi >1</span><span class=p >]</span> <span class=o >=</span> <span class=n >c44</span><span class=p >;</span> <span class=n >C4</span><span class=p >[</span><span class=mi >2</span><span class=p >,</span><span class=mi >0</span><span class=p >,</span><span class=mi >0</span><span class=p >,</span><span class=mi >2</span><span class=p >]</span> <span class=o >=</span> <span class=n >c44</span><span class=p >;</span>
    <span class=k >return</span><span class=p >(</span><span class=n >C4</span><span class=p >)</span>

<span class=n >uc2</span> <span class=o >=</span> <span class=mf >2.1375e2</span><span class=o >/</span><span class=mf >1e-5</span>
<span class=n >c11</span> <span class=o >=</span> <span class=mf >97.7e9</span><span class=p >;</span> <span class=n >c12</span> <span class=o >=</span> <span class=mf >82.7e9</span><span class=p >;</span> <span class=n >c44</span><span class=o >=</span><span class=mf >7.5e9</span><span class=p >;</span>
<span class=n >c11</span> <span class=o >=</span> <span class=n >c11</span><span class=o >/</span><span class=n >uc2</span><span class=p >;</span> <span class=n >c12</span> <span class=o >=</span> <span class=n >c12</span><span class=o >/</span><span class=n >uc2</span><span class=p >;</span> <span class=n >c44</span> <span class=o >=</span> <span class=n >c44</span><span class=o >/</span><span class=n >uc2</span><span class=p >;</span>
<span class=n >C4</span> <span class=o >=</span> <span class=n >C4cal</span><span class=p >(</span><span class=n >c11</span><span class=o >=</span><span class=n >c11</span><span class=p >,</span> <span class=n >c12</span><span class=o >=</span><span class=n >c12</span><span class=p >,</span> <span class=n >c44</span><span class=o >=</span><span class=n >c44</span><span class=p >)</span>
</pre></div> </div> </div> <p>张量运算<span class="math notranslate nohighlight">\(\Omega_{ij}^{-1}=C_{iklj}n_kn_l\)</span>，<span class="math notranslate nohighlight">\(\sigma_{ij}^p=C_{ijkl}\varepsilon_{kl}(p)\)</span>，应理解成爱因斯坦求和：</p> <div class="nbinput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[ ]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=kn >import</span> <span class=nn >numpy</span> <span class=k >as</span> <span class=nn >np</span>

<span class=k >def</span> <span class=nf >kscal</span><span class=p >(</span><span class=n >lx</span><span class=p >,</span> <span class=n >ly</span><span class=p >,</span> <span class=n >lz</span><span class=p >,</span> <span class=n >dx</span><span class=p >):</span> <span class=c1 ># 计算傅立叶空间基本量</span>
    <span class=n >dx</span><span class=o >=</span><span class=mi >1</span><span class=p >;</span> <span class=c1 ># 有些文献的傅立叶变换dx设定为1，注意到dx并不影响Bpq计算，有一定随意性</span>
    <span class=n >dkx</span> <span class=o >=</span> <span class=mi >2</span><span class=o >*</span><span class=n >np</span><span class=o >.</span><span class=n >pi</span><span class=o >/</span><span class=p >(</span><span class=n >lx</span><span class=o >*</span><span class=n >dx</span><span class=p >)</span>
    <span class=n >dky</span> <span class=o >=</span> <span class=mi >2</span><span class=o >*</span><span class=n >np</span><span class=o >.</span><span class=n >pi</span><span class=o >/</span><span class=p >(</span><span class=n >ly</span><span class=o >*</span><span class=n >dx</span><span class=p >)</span>
    <span class=n >dkz</span> <span class=o >=</span> <span class=mi >2</span><span class=o >*</span><span class=n >np</span><span class=o >.</span><span class=n >pi</span><span class=o >/</span><span class=p >(</span><span class=n >lz</span><span class=o >*</span><span class=n >dx</span><span class=p >)</span>
    <span class=n >kxlst</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >arange</span><span class=p >(</span><span class=n >lx</span><span class=p >)</span><span class=o >*</span><span class=n >dkx</span>
    <span class=n >kylst</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >arange</span><span class=p >(</span><span class=n >ly</span><span class=p >)</span><span class=o >*</span><span class=n >dkx</span>
    <span class=n >kzlst</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >arange</span><span class=p >(</span><span class=n >lz</span><span class=p >)</span><span class=o >*</span><span class=n >dkx</span>
    <span class=k >for</span> <span class=n >ix</span> <span class=ow >in</span> <span class=nb >range</span><span class=p >(</span><span class=n >lx</span><span class=p >):</span>
        <span class=k >if</span> <span class=p >(</span><span class=n >ix</span> <span class=o >&lt;</span> <span class=n >lx</span><span class=o >/</span><span class=mi >2</span><span class=p >):</span>
            <span class=n >kxlst</span><span class=p >[</span><span class=n >ix</span><span class=p >]</span> <span class=o >=</span> <span class=n >ix</span> <span class=o >*</span> <span class=n >dkx</span>
        <span class=k >else</span><span class=p >:</span>
            <span class=n >kxlst</span><span class=p >[</span><span class=n >ix</span><span class=p >]</span> <span class=o >=</span> <span class=p >(</span><span class=n >ix</span><span class=o >-</span><span class=n >lx</span><span class=p >)</span> <span class=o >*</span> <span class=n >dkx</span>
    <span class=p >[</span><span class=n >kx</span><span class=p >,</span> <span class=n >ky</span><span class=p >,</span> <span class=n >kz</span><span class=p >]</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >meshgrid</span><span class=p >(</span><span class=n >kxlst</span><span class=p >,</span> <span class=n >kylst</span><span class=p >,</span> <span class=n >kzlst</span><span class=p >,</span> <span class=n >indexing</span><span class=o >=</span><span class=s1 >'ij'</span><span class=p >)</span>
    <span class=n >k2</span> <span class=o >=</span> <span class=n >kx</span><span class=o >**</span><span class=mi >2</span> <span class=o >+</span> <span class=n >ky</span><span class=o >**</span><span class=mi >2</span> <span class=o >+</span> <span class=n >kz</span><span class=o >**</span><span class=mi >2</span>
    <span class=n >nx</span> <span class=o >=</span> <span class=n >kx</span> <span class=o >/</span> <span class=n >np</span><span class=o >.</span><span class=n >sqrt</span><span class=p >(</span><span class=n >k2</span><span class=p >);</span> <span class=n >nx</span><span class=p >[</span><span class=mi >0</span><span class=p >,</span><span class=mi >0</span><span class=p >,</span><span class=mi >0</span><span class=p >]</span><span class=o >=</span><span class=mi >0</span>
    <span class=n >ny</span> <span class=o >=</span> <span class=n >ky</span> <span class=o >/</span> <span class=n >np</span><span class=o >.</span><span class=n >sqrt</span><span class=p >(</span><span class=n >k2</span><span class=p >);</span> <span class=n >ny</span><span class=p >[</span><span class=mi >0</span><span class=p >,</span><span class=mi >0</span><span class=p >,</span><span class=mi >0</span><span class=p >]</span><span class=o >=</span><span class=mi >0</span>
    <span class=n >nz</span> <span class=o >=</span> <span class=n >kz</span> <span class=o >/</span> <span class=n >np</span><span class=o >.</span><span class=n >sqrt</span><span class=p >(</span><span class=n >k2</span><span class=p >);</span> <span class=n >nz</span><span class=p >[</span><span class=mi >0</span><span class=p >,</span><span class=mi >0</span><span class=p >,</span><span class=mi >0</span><span class=p >]</span><span class=o >=</span><span class=mi >0</span>
    <span class=k >return</span><span class=p >(</span><span class=n >kx</span><span class=p >,</span> <span class=n >ky</span><span class=p >,</span> <span class=n >kz</span><span class=p >,</span> <span class=n >nx</span><span class=p >,</span> <span class=n >ny</span><span class=p >,</span> <span class=n >nz</span><span class=p >)</span>

<span class=k >def</span> <span class=nf >Bpqcal</span><span class=p >(</span><span class=n >lx</span><span class=p >,</span> <span class=n >ly</span><span class=p >,</span> <span class=n >lz</span><span class=p >,</span> <span class=n >nx</span><span class=p >,</span> <span class=n >ny</span><span class=p >,</span> <span class=n >nz</span><span class=p >,</span> <span class=n >C4</span><span class=p >,</span> <span class=n >e2</span><span class=p >):</span>  <span class=c1 ># 计算Bpq(nx, ny, nz, 6variant, 6variant)</span>
    <span class=n >s</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >zeros</span><span class=p >((</span><span class=mi >3</span><span class=p >,</span><span class=mi >3</span><span class=p >,</span><span class=mi >6</span><span class=p >))</span> <span class=c1 ># stress tensor (3D,3D,6variant)</span>
    <span class=k >for</span> <span class=n >v</span> <span class=ow >in</span> <span class=nb >range</span><span class=p >(</span><span class=mi >6</span><span class=p >):</span>
        <span class=k >for</span> <span class=n >i</span> <span class=ow >in</span> <span class=nb >range</span><span class=p >(</span><span class=mi >3</span><span class=p >):</span>
            <span class=k >for</span> <span class=n >j</span> <span class=ow >in</span> <span class=nb >range</span><span class=p >(</span><span class=mi >3</span><span class=p >):</span> <span class=c1 ># 注意这里不是矩阵乘而是元素乘</span>
                <span class=n >s</span><span class=p >[</span><span class=n >i</span><span class=p >,</span><span class=n >j</span><span class=p >,</span><span class=n >v</span><span class=p >]</span> <span class=o >=</span> <span class=n >C4</span><span class=p >[</span><span class=n >i</span><span class=p >,</span><span class=n >j</span><span class=p >,</span><span class=mi >0</span><span class=p >,</span><span class=mi >0</span><span class=p >]</span><span class=o >*</span><span class=n >e2</span><span class=p >[</span><span class=mi >0</span><span class=p >,</span><span class=mi >0</span><span class=p >,</span><span class=n >v</span><span class=p >]</span> <span class=o >+</span> <span class=n >C4</span><span class=p >[</span><span class=n >i</span><span class=p >,</span><span class=n >j</span><span class=p >,</span><span class=mi >1</span><span class=p >,</span><span class=mi >1</span><span class=p >]</span><span class=o >*</span><span class=n >e2</span><span class=p >[</span><span class=mi >1</span><span class=p >,</span><span class=mi >1</span><span class=p >,</span><span class=n >v</span><span class=p >]</span> <span class=o >+</span> <span class=n >C4</span><span class=p >[</span><span class=n >i</span><span class=p >,</span><span class=n >j</span><span class=p >,</span><span class=mi >2</span><span class=p >,</span><span class=mi >2</span><span class=p >]</span><span class=o >*</span><span class=n >e2</span><span class=p >[</span><span class=mi >2</span><span class=p >,</span><span class=mi >2</span><span class=p >,</span><span class=n >v</span><span class=p >]</span> \
                <span class=o >+</span> <span class=n >C4</span><span class=p >[</span><span class=n >i</span><span class=p >,</span><span class=n >j</span><span class=p >,</span><span class=mi >0</span><span class=p >,</span><span class=mi >1</span><span class=p >]</span><span class=o >*</span><span class=n >e2</span><span class=p >[</span><span class=mi >0</span><span class=p >,</span><span class=mi >1</span><span class=p >,</span><span class=n >v</span><span class=p >]</span> <span class=o >+</span> <span class=n >C4</span><span class=p >[</span><span class=n >i</span><span class=p >,</span><span class=n >j</span><span class=p >,</span><span class=mi >0</span><span class=p >,</span><span class=mi >2</span><span class=p >]</span><span class=o >*</span><span class=n >e2</span><span class=p >[</span><span class=mi >0</span><span class=p >,</span><span class=mi >2</span><span class=p >,</span><span class=n >v</span><span class=p >]</span> <span class=o >+</span> <span class=n >C4</span><span class=p >[</span><span class=n >i</span><span class=p >,</span><span class=n >j</span><span class=p >,</span><span class=mi >1</span><span class=p >,</span><span class=mi >2</span><span class=p >]</span><span class=o >*</span><span class=n >e2</span><span class=p >[</span><span class=mi >1</span><span class=p >,</span><span class=mi >2</span><span class=p >,</span><span class=n >v</span><span class=p >]</span> \
                <span class=o >+</span> <span class=n >C4</span><span class=p >[</span><span class=n >i</span><span class=p >,</span><span class=n >j</span><span class=p >,</span><span class=mi >1</span><span class=p >,</span><span class=mi >0</span><span class=p >]</span><span class=o >*</span><span class=n >e2</span><span class=p >[</span><span class=mi >1</span><span class=p >,</span><span class=mi >0</span><span class=p >,</span><span class=n >v</span><span class=p >]</span> <span class=o >+</span> <span class=n >C4</span><span class=p >[</span><span class=n >i</span><span class=p >,</span><span class=n >j</span><span class=p >,</span><span class=mi >0</span><span class=p >,</span><span class=mi >2</span><span class=p >]</span><span class=o >*</span><span class=n >e2</span><span class=p >[</span><span class=mi >0</span><span class=p >,</span><span class=mi >2</span><span class=p >,</span><span class=n >v</span><span class=p >]</span> <span class=o >+</span> <span class=n >C4</span><span class=p >[</span><span class=n >i</span><span class=p >,</span><span class=n >j</span><span class=p >,</span><span class=mi >1</span><span class=p >,</span><span class=mi >2</span><span class=p >]</span><span class=o >*</span><span class=n >e2</span><span class=p >[</span><span class=mi >1</span><span class=p >,</span><span class=mi >2</span><span class=p >,</span><span class=n >v</span><span class=p >]</span>
                <span class=c1 ># 因为Cij矩阵和e2ij矩阵是对称的，所以有的代码的上两行也写成2*（blahblah）</span>
    <span class=n >Bpq</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >zeros</span><span class=p >((</span><span class=n >lx</span><span class=p >,</span> <span class=n >ly</span><span class=p >,</span> <span class=n >lz</span><span class=p >,</span> <span class=mi >6</span><span class=p >,</span> <span class=mi >6</span><span class=p >))</span> <span class=c1 ># 每个坐标点lx, ly, lz上都有variant*variant</span>
    <span class=n >iomega</span><span class=o >=</span><span class=n >np</span><span class=o >.</span><span class=n >zeros</span><span class=p >((</span><span class=mi >3</span><span class=p >,</span><span class=mi >3</span><span class=p >))</span> <span class=c1 ># \Omega_{ij}^{-1}，每个坐标上都有不同的Omega，得遍历来算</span>
    <span class=k >for</span> <span class=n >ix</span> <span class=ow >in</span> <span class=nb >range</span><span class=p >(</span><span class=n >lx</span><span class=p >):</span>
        <span class=k >for</span> <span class=n >iy</span> <span class=ow >in</span> <span class=nb >range</span><span class=p >(</span><span class=n >ly</span><span class=p >):</span>
            <span class=k >for</span> <span class=n >iz</span> <span class=ow >in</span> <span class=nb >range</span><span class=p >(</span><span class=n >lz</span><span class=p >):</span>
                <span class=n >n0</span> <span class=o >=</span> <span class=n >nx</span><span class=p >[</span><span class=n >ix</span><span class=p >,</span> <span class=n >iy</span><span class=p >,</span> <span class=n >iz</span><span class=p >]</span>
                <span class=n >n1</span> <span class=o >=</span> <span class=n >ny</span><span class=p >[</span><span class=n >ix</span><span class=p >,</span> <span class=n >iy</span><span class=p >,</span> <span class=n >iz</span><span class=p >]</span>
                <span class=n >n2</span> <span class=o >=</span> <span class=n >nz</span><span class=p >[</span><span class=n >ix</span><span class=p >,</span> <span class=n >iy</span><span class=p >,</span> <span class=n >iz</span><span class=p >]</span>
                <span class=n >n</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >array</span><span class=p >([</span><span class=n >n0</span><span class=p >,</span> <span class=n >n1</span><span class=p >,</span> <span class=n >n2</span><span class=p >])</span>
                <span class=c1 ># 至此，每个坐标n向量计算完毕</span>
                <span class=k >for</span> <span class=n >i</span> <span class=ow >in</span> <span class=nb >range</span><span class=p >(</span><span class=mi >3</span><span class=p >):</span>
                    <span class=k >for</span> <span class=n >j</span> <span class=ow >in</span> <span class=nb >range</span><span class=p >(</span><span class=mi >3</span><span class=p >):</span>
                        <span class=n >iomega</span><span class=p >[</span><span class=n >i</span><span class=p >,</span><span class=n >j</span><span class=p >]</span> <span class=o >=</span> <span class=n >C4</span><span class=p >[</span><span class=n >i</span><span class=p >,</span><span class=mi >0</span><span class=p >,</span><span class=mi >0</span><span class=p >,</span><span class=n >j</span><span class=p >]</span><span class=o >*</span><span class=n >n0</span><span class=o >*</span><span class=n >n0</span> <span class=o >+</span> <span class=n >C4</span><span class=p >[</span><span class=n >i</span><span class=p >,</span><span class=mi >0</span><span class=p >,</span><span class=mi >1</span><span class=p >,</span><span class=n >j</span><span class=p >]</span><span class=o >*</span><span class=n >n0</span><span class=o >*</span><span class=n >n1</span> <span class=o >+</span> <span class=n >C4</span><span class=p >[</span><span class=n >i</span><span class=p >,</span><span class=mi >0</span><span class=p >,</span><span class=mi >2</span><span class=p >,</span><span class=n >j</span><span class=p >]</span><span class=o >*</span><span class=n >n0</span><span class=o >*</span><span class=n >n2</span> \
                        <span class=o >+</span> <span class=n >C4</span><span class=p >[</span><span class=n >i</span><span class=p >,</span><span class=mi >1</span><span class=p >,</span><span class=mi >0</span><span class=p >,</span><span class=n >j</span><span class=p >]</span><span class=o >*</span><span class=n >n1</span><span class=o >*</span><span class=n >n0</span> <span class=o >+</span> <span class=n >C4</span><span class=p >[</span><span class=n >i</span><span class=p >,</span><span class=mi >1</span><span class=p >,</span><span class=mi >1</span><span class=p >,</span><span class=n >j</span><span class=p >]</span><span class=o >*</span><span class=n >n1</span><span class=o >*</span><span class=n >n1</span> <span class=o >+</span> <span class=n >C4</span><span class=p >[</span><span class=n >i</span><span class=p >,</span><span class=mi >1</span><span class=p >,</span><span class=mi >2</span><span class=p >,</span><span class=n >j</span><span class=p >]</span><span class=o >*</span><span class=n >n1</span><span class=o >*</span><span class=n >n2</span> \
                        <span class=o >+</span> <span class=n >C4</span><span class=p >[</span><span class=n >i</span><span class=p >,</span><span class=mi >2</span><span class=p >,</span><span class=mi >0</span><span class=p >,</span><span class=n >j</span><span class=p >]</span><span class=o >*</span><span class=n >n2</span><span class=o >*</span><span class=n >n0</span> <span class=o >+</span> <span class=n >C4</span><span class=p >[</span><span class=n >i</span><span class=p >,</span><span class=mi >2</span><span class=p >,</span><span class=mi >1</span><span class=p >,</span><span class=n >j</span><span class=p >]</span><span class=o >*</span><span class=n >n2</span><span class=o >*</span><span class=n >n1</span> <span class=o >+</span> <span class=n >C4</span><span class=p >[</span><span class=n >i</span><span class=p >,</span><span class=mi >2</span><span class=p >,</span><span class=mi >2</span><span class=p >,</span><span class=n >j</span><span class=p >]</span><span class=o >*</span><span class=n >n2</span><span class=o >*</span><span class=n >n2</span>
                <span class=k >if</span> <span class=p >(</span><span class=n >ix</span><span class=o >==</span><span class=mi >0</span> <span class=ow >and</span> <span class=n >iy</span><span class=o >==</span><span class=mi >0</span> <span class=ow >and</span> <span class=n >iz</span><span class=o >==</span><span class=mi >0</span><span class=p >):</span>
                    <span class=n >omega</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >zeros</span><span class=p >((</span><span class=mi >3</span><span class=p >,</span><span class=mi >3</span><span class=p >))</span>
                <span class=k >else</span><span class=p >:</span>
                    <span class=n >omega</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >linalg</span><span class=o >.</span><span class=n >inv</span><span class=p >(</span><span class=n >iomega</span><span class=p >)</span>
                <span class=c1 ># 至此，每个坐标omega计算完毕</span>
                <span class=k >for</span> <span class=n >p</span> <span class=ow >in</span> <span class=nb >range</span><span class=p >(</span><span class=mi >6</span><span class=p >):</span>
                    <span class=k >for</span> <span class=n >q</span> <span class=ow >in</span> <span class=nb >range</span><span class=p >(</span><span class=mi >6</span><span class=p >):</span>
                        <span class=c1 ># 每个变体</span>
                        <span class=k >for</span> <span class=n >i</span> <span class=ow >in</span> <span class=nb >range</span><span class=p >(</span><span class=mi >3</span><span class=p >):</span>
                            <span class=k >for</span> <span class=n >j</span> <span class=ow >in</span> <span class=nb >range</span><span class=p >(</span><span class=mi >3</span><span class=p >):</span>
                                <span class=k >for</span> <span class=n >k</span> <span class=ow >in</span> <span class=nb >range</span><span class=p >(</span><span class=mi >3</span><span class=p >):</span>
                                    <span class=k >for</span> <span class=n >l</span> <span class=ow >in</span> <span class=nb >range</span><span class=p >(</span><span class=mi >3</span><span class=p >):</span>
                                        <span class=n >Bpq</span><span class=p >[</span><span class=n >ix</span><span class=p >,</span> <span class=n >iy</span><span class=p >,</span> <span class=n >iz</span><span class=p >,</span> <span class=n >p</span><span class=p >,</span> <span class=n >q</span><span class=p >]</span> <span class=o >=</span> <span class=n >Bpq</span><span class=p >[</span><span class=n >ix</span><span class=p >,</span> <span class=n >iy</span><span class=p >,</span> <span class=n >iz</span><span class=p >,</span> <span class=n >p</span><span class=p >,</span> <span class=n >q</span><span class=p >]</span> <span class=o >+</span> <span class=n >C4</span><span class=p >[</span><span class=n >i</span><span class=p >,</span><span class=n >j</span><span class=p >,</span><span class=n >k</span><span class=p >,</span><span class=n >l</span><span class=p >]</span><span class=o >*</span><span class=n >e2</span><span class=p >[</span><span class=n >i</span><span class=p >,</span><span class=n >j</span><span class=p >,</span><span class=n >p</span><span class=p >]</span><span class=o >*</span><span class=n >e2</span><span class=p >[</span><span class=n >k</span><span class=p >,</span><span class=n >l</span><span class=p >,</span><span class=n >q</span><span class=p >]</span>
                        <span class=c1 ># 至此，每个变体Bpq的前半部分计算完毕</span>
                        <span class=n >Bpq</span><span class=p >[</span><span class=n >ix</span><span class=p >,</span> <span class=n >iy</span><span class=p >,</span> <span class=n >iz</span><span class=p >,</span> <span class=n >p</span><span class=p >,</span> <span class=n >q</span><span class=p >]</span> <span class=o >=</span> <span class=n >Bpq</span><span class=p >[</span><span class=n >ix</span><span class=p >,</span> <span class=n >iy</span><span class=p >,</span> <span class=n >iz</span><span class=p >,</span> <span class=n >p</span><span class=p >,</span> <span class=n >q</span><span class=p >]</span> \
                            <span class=o >-</span> <span class=n >np</span><span class=o >.</span><span class=n >matmul</span><span class=p >(</span><span class=n >n</span><span class=p >,</span> <span class=n >np</span><span class=o >.</span><span class=n >matmul</span><span class=p >(</span><span class=n >s</span><span class=p >[:,:,</span><span class=n >p</span><span class=p >],</span> <span class=n >np</span><span class=o >.</span><span class=n >matmul</span><span class=p >(</span><span class=n >omega</span><span class=p >,</span> <span class=n >np</span><span class=o >.</span><span class=n >matmul</span><span class=p >(</span><span class=n >s</span><span class=p >[:,:,</span><span class=n >q</span><span class=p >],</span> <span class=n >np</span><span class=o >.</span><span class=n >transpose</span><span class=p >(</span><span class=n >n</span><span class=p >)))))</span>
    <span class=k >return</span><span class=p >(</span><span class=n >Bpq</span><span class=p >)</span>

<span class=n >lx</span> <span class=o >=</span> <span class=mi >8</span><span class=p >;</span> <span class=n >ly</span> <span class=o >=</span> <span class=mi >6</span><span class=p >;</span> <span class=n >lz</span> <span class=o >=</span> <span class=mi >4</span><span class=p >;</span>
<span class=p >(</span><span class=n >kx</span><span class=p >,</span> <span class=n >ky</span><span class=p >,</span> <span class=n >kz</span><span class=p >,</span> <span class=n >nx</span><span class=p >,</span> <span class=n >ny</span><span class=p >,</span> <span class=n >nz</span><span class=p >)</span> <span class=o >=</span> <span class=n >kscal</span><span class=p >(</span><span class=n >lx</span><span class=o >=</span><span class=n >lx</span><span class=p >,</span> <span class=n >ly</span><span class=o >=</span><span class=n >ly</span><span class=p >,</span> <span class=n >lz</span><span class=o >=</span><span class=n >lz</span><span class=p >,</span> <span class=n >dx</span><span class=o >=</span><span class=mf >0.5</span><span class=p >)</span>
<span class=n >Bpq</span> <span class=o >=</span> <span class=n >Bpqcal</span><span class=p >(</span><span class=n >lx</span><span class=o >=</span><span class=n >lx</span><span class=p >,</span> <span class=n >ly</span><span class=o >=</span><span class=n >ly</span><span class=p >,</span> <span class=n >lz</span><span class=o >=</span><span class=n >lz</span><span class=p >,</span> <span class=n >nx</span><span class=o >=</span><span class=n >nx</span><span class=p >,</span> <span class=n >ny</span><span class=o >=</span><span class=n >ny</span><span class=p >,</span> <span class=n >nz</span><span class=o >=</span><span class=n >nz</span><span class=p >,</span> <span class=n >C4</span><span class=o >=</span><span class=n >C4</span><span class=p >,</span> <span class=n >e2</span><span class=o >=</span><span class=n >e2</span><span class=p >)</span>
</pre></div> </div> </div> </section> </section> </section> </article> </div> </div> </main> </div> <footer class=md-footer > <div class=md-footer-nav > <nav class="md-footer-nav__inner md-grid"> </a> </nav> </div> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright > <div class=md-footer-copyright__highlight > &#169; Copyright 2024, chat dans le bâtiment 5. </div> Created using <a href="http://www.sphinx-doc.org/">Sphinx</a> 8.0.2. and <a href="https://github.com/bashtage/sphinx-material/">Material for Sphinx</a> </div> </div> </div> </footer> <script src="../_static/javascripts/application.js"></script> <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>